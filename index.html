<!doctype html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Mastro Distillatore</title>

  <!-- iOS: app-like -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-title" content="Mastro Distillatore" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#a54a12" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest" />

  <!-- Icone iOS (SENZA file esterni): SVG inline via data URL -->
  <!-- iPhone/iPad useranno queste quando fai “Aggiungi a Home”. -->
  <link rel="apple-touch-icon" sizes="180x180"
        href="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20viewBox%3D%270%200%201024%201024%27%3E%3Cdefs%3E%3CradialGradient%20id%3D%27g%27%20cx%3D%2730%25%27%20cy%3D%2725%25%27%20r%3D%2790%25%27%3E%3Cstop%20offset%3D%270%25%27%20stop-color%3D%27%23ffdfb6%27/%3E%3Cstop%20offset%3D%2735%25%27%20stop-color%3D%27%23f6b25f%27/%3E%3Cstop%20offset%3D%2765%25%27%20stop-color%3D%27%23b45309%27/%3E%3Cstop%20offset%3D%27100%25%27%20stop-color%3D%27%2318140d%27/%3E%3C/radialGradient%3E%3Cfilter%20id%3D%27n%27%20x%3D%27-20%25%27%20y%3D%27-20%25%27%20width%3D%27140%25%27%20height%3D%27140%25%27%3E%3CfeTurbulence%20type%3D%27fractalNoise%27%20baseFrequency%3D%270.9%27%20numOctaves%3D%272%27%20stitchTiles%3D%27stitch%27/%3E%3CfeColorMatrix%20type%3D%27matrix%27%20values%3D%270%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.08%200%27/%3E%3C/filter%3E%3ClinearGradient%20id%3D%27glass%27%20x1%3D%270%27%20y1%3D%270%27%20x2%3D%271%27%20y2%3D%271%27%3E%3Cstop%20offset%3D%270%27%20stop-color%3D%27%23ffffff%27%20stop-opacity%3D%270.85%27/%3E%3Cstop%20offset%3D%271%27%20stop-color%3D%27%23ffffff%27%20stop-opacity%3D%270.15%27/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect%20width%3D%271024%27%20height%3D%271024%27%20rx%3D%27220%27%20fill%3D%27url(%23g)%27/%3E%3Crect%20width%3D%271024%27%20height%3D%271024%27%20rx%3D%27220%27%20filter%3D%27url(%23n)%27%20opacity%3D%270.9%27/%3E%3Cpath%20d%3D%27M665%20218c0%2058-41%20103-97%20118l-5%201h-5c-57-4-102-51-102-110%200-54%2038-98%2090-108%2012-2%2024-2%2036%200%2052%2010%2083%2052%2083%2099z%27%20fill%3D%27%23ffd7a2%27%20opacity%3D%270.25%27/%3E%3Cpath%20d%3D%27M780%20325c-74%2047-131%2074-187%2092-21%207-42%2012-64%2017%200%20115%200%20229%200%20344%200%2035-4%2071-12%20105-7%2030-18%2060-33%2088-6%2012-13%2023-20%2034%20l-14%2021c-10%2013-25%2021-42%2021H317c-17%200-33-8-43-22-8-11-15-22-21-34-16-28-27-58-34-88-8-34-11-70-11-105%200-115%200-229%200-344-22-5-43-10-64-17-56-18-113-45-187-92-21-13-27-41-14-62%2013-21%2041-27%2062-14%2067%2043%20118%2067%20168%2083%2020%206%2039%2011%2058%2015%2021%204%2041%208%2061%2011%2020-3%2040-7%2061-11%2019-4%2038-9%2058-15%2050-16%20101-40%20168-83%2021-13%2049-7%2062%2014%2013%2021%207%2049-14%2062z%27%20fill%3D%27%23ffffff%27%20opacity%3D%270.16%27/%3E%3Cpath%20d%3D%27M512%20356c-103%200-186%2083-186%20186%200%2040%2012%2078%2033%20109%203%205%206%2010%209%2014%2027%2044%2041%2090%2044%20138%202%2032-2%2065-12%2096-18%2058-47%2097-61%20117-1%202-2%203-3%205%2033%2028%2075%2045%20121%2045%20103%200%20186-83%20186-186s-83-186-186-186z%27%20fill%3D%27url(%23glass)%27%20stroke%3D%27%23ffffff%27%20stroke-opacity%3D%270.25%27%20stroke-width%3D%2712%27/%3E%3Cpath%20d%3D%27M692%20290c0%2061-50%20110-112%20110-62%200-112-49-112-110%200-61%2050-110%20112-110%2062%200%20112%2049%20112%20110z%27%20fill%3D%27%23ffffff%27%20opacity%3D%270.08%27/%3E%3Cpath%20d%3D%27M640%20238c-8%2011-33%2021-61%2021s-53-10-61-21c-6-8-4-20%204-26%2013-10%2036-17%2057-17s44%207%2057%2017c8%206%2010%2018%204%2026z%27%20fill%3D%27%23fff%27%20opacity%3D%270.18%27/%3E%3Cpath%20d%3D%27M438%20762c-10%2028-30%2047-62%2047-32%200-55-18-69-47-7-14-2-31%2012-38%2014-7%2031-2%2038%2012%206%2013%2010%2018%2019%2018%2010%200%2016-6%2020-18%205-14%2021-20%2035-15%2014%205%2022%2021%2017%2041z%27%20fill%3D%27%23ffecce%27%20opacity%3D%270.28%27/%3E%3Cpath%20d%3D%27M319%20472c18-78%2088-136%20177-136%2070%200%20132%2037%20161%2092%208%2015%202%2034-13%2042-15%208-34%202-42-13-19-36-58-61-106-61-62%200-102%2038-114%2090-4%2017-21%2028-38%2024-17-4-28-21-25-38z%27%20fill%3D%27%23ffffff%27%20opacity%3D%270.16%27/%3E%3Cpath%20d%3D%27M730%20526c-10-15-30-19-45-9-24%2016-51%2026-80%2030-17%202-29%2018-27%2035%202%2017%2018%2029%2035%2027%2037-5%2072-19%20103-39%2015-10%2019-30%209-44z%27%20fill%3D%27%23ffffff%27%20opacity%3D%270.16%27/%3E%3Cpath%20d%3D%27M781%20324c-74%2047-131%2074-187%2092-21%207-42%2012-64%2017%200%2052%200%20103%200%20155%206%200%2013%200%2019%200%2029-1%2057-3%2085-6%2012-1%2022-7%2028-18%2010-18%204-41-14-51-16-11-39-15-69-15-18%200-36%201-54%203%20-4%200-8%201-12%201%20-5%200-9%200-14%200%20-5%200-10%200-15%200-33%200-65%204-96%2010-10%202-20%201-28-6-8-7-12-17-10-27%204-56%205-85%206-6%200-13%200-19%200%200-52%200-103%200-155-22-5-43-10-64-17-56-18-113-45-187-92-21-13-27-41-14-62%2013-21%2041-27%2062-14%2067%2043%20118%2067%20168%2083%2020%206%2039%2011%2058%2015%2021%204%2041%208%2061%2011%2020-3%2040-7%2061-11%2019-4%2038-9%2058-15%2050-16%20101-40%20168-83%2021-13%2049-7%2062%2014%2013%2021%207%2049-14%2062z%27%20fill%3D%27none%27%20stroke%3D%27%23ffedd5%27%20stroke-opacity%3D%270.35%27%20stroke-width%3D%2714%27/%3E%3Cpath%20d%3D%27M640%20210c0%2050-40%2090-90%2090s-90-40-90-90%2040-90%2090-90%2090%2040%2090%2090z%27%20fill%3D%27none%27%20stroke%3D%27%23ffedd5%27%20stroke-opacity%3D%270.35%27%20stroke-width%3D%2714%27/%3E%3Cpath%20d%3D%27M512%20888c-125%200-226-101-226-226%200-125%20101-226%20226-226%20125%200%20226%20101%20226%20226%200%20125-101%20226-226%20226z%27%20fill%3D%27none%27%20stroke%3D%27%23ffedd5%27%20stroke-opacity%3D%270.28%27%20stroke-width%3D%2714%27/%3E%3Cpath%20d%3D%27M418%20588c0-52%2042-94%2094-94%2052%200%2094%2042%2094%2094%200%2052-42%2094-94%2094-52%200-94-42-94-94z%27%20fill%3D%27%23ffffff%27%20opacity%3D%270.08%27/%3E%3Cpath%20d%3D%27M470%20588c0-23%2019-42%2042-42%2023%200%2042%2019%2042%2042%200%2023-19%2042-42%2042-23%200-42-19-42-42z%27%20fill%3D%27%23ffffff%27%20opacity%3D%270.11%27/%3E%3C/svg%3E" />

  <!-- Optional: favicon for desktop -->
  <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20viewBox%3D%270%200%201024%201024%27%3E%3Crect%20width%3D%271024%27%20height%3D%271024%27%20rx%3D%27220%27%20fill%3D%27%23b45309%27/%3E%3Cpath%20d%3D%27M780%20325c-74%2047-131%2074-187%2092-21%207-42%2012-64%2017%200%20115%200%20229%200%20344%200%2035-4%2071-12%20105-7%2030-18%2060-33%2088-6%2012-13%2023-20%2034%20l-14%2021c-10%2013-25%2021-42%2021H317c-17%200-33-8-43-22-8-11-15-22-21-34-16-28-27-58-34-88-8-34-11-70-11-105%200-115%200-229%200-344-22-5-43-10-64-17-56-18-113-45-187-92-21-13-27-41-14-62%2013-21%2041-27%2062-14%2067%2043%20118%2067%20168%2083%2020%206%2039%2011%2058%2015%2021%204%2041%208%2061%2011%2020-3%2040-7%2061-11%2019-4%2038-9%2058-15%2050-16%20101-40%20168-83%2021-13%2049-7%2062%2014%2013%2021%207%2049-14%2062z%27%20fill%3D%27%23fff%27%20opacity%3D%270.22%27/%3E%3Cpath%20d%3D%27M512%20356c-103%200-186%2083-186%20186%200%2040%2012%2078%2033%20109%203%205%206%2010%209%2014%2027%2044%2041%2090%2044%20138%202%2032-2%2065-12%2096-18%2058-47%2097-61%20117%2033%2028%2075%2045%20121%2045%20103%200%20186-83%20186-186s-83-186-186-186z%27%20fill%3D%27%23fff%27%20opacity%3D%270.14%27/%3E%3C/svg%3E" />

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,600,750&family=Inter:wght@400;500;650&display=swap');

    :root{
      --bg0:#0b0a08;
      --bg1:#140f0a;
      --card:rgba(255,255,255,.06);
      --stroke:rgba(255,255,255,.12);
      --text:#f5efe6;
      --muted:rgba(245,239,230,.72);
      --amber:#f6b25f;
      --copper:#b45309;
      --danger:#ff4d4d;
      --ok:#37d38a;
      --shadow: 0 30px 80px rgba(0,0,0,.55);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family: Inter, system-ui, -apple-system, Segoe UI, sans-serif;
      background:
        radial-gradient(1200px 800px at 15% 10%, rgba(246,178,95,.22), transparent 60%),
        radial-gradient(900px 700px at 85% 20%, rgba(180,83,9,.28), transparent 55%),
        radial-gradient(1100px 900px at 50% 95%, rgba(255,255,255,.06), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    /* subtle grain */
    body::before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20width%3D%27120%27%20height%3D%27120%27%3E%3Cfilter%20id%3D%27n%27%3E%3CfeTurbulence%20type%3D%27fractalNoise%27%20baseFrequency%3D%270.9%27%20numOctaves%3D%272%27/%3E%3C/filter%3E%3Crect%20width%3D%27120%27%20height%3D%27120%27%20filter%3D%27url(%23n)%27%20opacity%3D%270.18%27/%3E%3C/svg%3E");
      mix-blend-mode:overlay;
      opacity:.55;
    }

    .wrap{
      min-height:100%;
      display:grid;
      place-items:center;
      padding: clamp(14px, 3.2vw, 28px);
    }

    .shell{
      width:min(980px, 100%);
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: clamp(14px, 2.6vw, 22px);
      align-items:start;
    }

    @media (max-width: 860px){
      .shell{grid-template-columns:1fr}
    }

    header{
      position:relative;
      border:1px solid var(--stroke);
      background: linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      border-radius: 26px;
      padding: clamp(18px, 3vw, 26px);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    header::after{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(500px 260px at 15% 15%, rgba(246,178,95,.35), transparent 60%),
        radial-gradient(420px 320px at 85% 35%, rgba(180,83,9,.38), transparent 60%);
      filter: blur(10px);
      opacity:.9;
      z-index:0;
    }

    .hero{
      position:relative;
      z-index:1;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:16px;
    }

    .brand h1{
      margin:0;
      font-family: Fraunces, serif;
      font-weight: 750;
      letter-spacing: -0.02em;
      font-size: clamp(28px, 3.2vw, 40px);
      line-height:1.05;
    }
    .brand p{
      margin:10px 0 0;
      color:var(--muted);
      font-size: 14px;
      max-width: 52ch;
    }

    .badge{
      flex:0 0 auto;
      border:1px solid rgba(246,178,95,.35);
      background: rgba(246,178,95,.10);
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 12px;
      color: rgba(255,235,205,.92);
      display:flex;
      gap:10px;
      align-items:center;
      white-space:nowrap;
      backdrop-filter: blur(10px);
    }
    .dot{
      width:9px; height:9px; border-radius:99px;
      background: radial-gradient(circle at 30% 30%, #fff, var(--amber));
      box-shadow: 0 0 0 3px rgba(246,178,95,.12), 0 0 18px rgba(246,178,95,.35);
    }

    .panel{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.05);
      border-radius: 26px;
      padding: clamp(16px, 2.2vw, 22px);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
    }

    .grid{
      display:grid;
      gap:14px;
      margin-top: 16px;
    }

    label{
      display:block;
      font-size: 12px;
      letter-spacing: .12em;
      text-transform: uppercase;
      color: rgba(245,239,230,.72);
      margin: 0 0 8px;
    }

    select, input{
      width:100%;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(10,10,10,.35);
      color: var(--text);
      padding: 14px 14px;
      outline:none;
      font-size: 16px;
      transition: transform .12s ease, border-color .12s ease, box-shadow .12s ease;
    }
    select:focus, input:focus{
      border-color: rgba(246,178,95,.55);
      box-shadow: 0 0 0 6px rgba(246,178,95,.14);
    }
    input[type="number"]{appearance:textfield}
    input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{appearance:none; margin:0}

    .two{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 420px){
      .two{grid-template-columns:1fr}
    }

    .ingredients{
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      padding: 14px 14px;
    }
    .ingredients h3{
      margin:0 0 10px;
      font-size: 13px;
      letter-spacing:.10em;
      text-transform: uppercase;
      color: rgba(246,178,95,.95);
    }
    ul{margin:0; padding-left: 18px; color: rgba(245,239,230,.78); font-size: 13px; line-height:1.45}
    li{margin:6px 0}

    .btn{
      width:100%;
      border-radius: 18px;
      border:1px solid rgba(246,178,95,.40);
      background:
        linear-gradient(135deg, rgba(246,178,95,.32), rgba(180,83,9,.22));
      color: rgba(255,245,233,.96);
      padding: 14px 16px;
      font-weight: 700;
      letter-spacing:.14em;
      text-transform: uppercase;
      cursor:pointer;
      transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
      box-shadow: 0 18px 55px rgba(180,83,9,.25);
    }
    .btn:hover{transform: translateY(-1px); filter: brightness(1.05)}
    .btn:active{transform: translateY(1px) scale(.99)}

    .results{
      display:none;
      margin-top: 14px;
      gap: 12px;
    }
    .results.show{display:grid}

    .cut{
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      padding: 14px 14px;
      background: rgba(0,0,0,.22);
      position:relative;
      overflow:hidden;
    }
    .cut::before{
      content:"";
      position:absolute; inset:0;
      opacity:.9;
      pointer-events:none;
      background: radial-gradient(600px 200px at 20% 0%, rgba(255,255,255,.10), transparent 55%);
    }
    .cut h4{
      margin:0;
      font-size: 13px;
      letter-spacing:.10em;
      text-transform: uppercase;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .temp{
      font-size: 11px;
      padding: 6px 10px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: rgba(245,239,230,.85);
      white-space:nowrap;
    }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 26px;
      margin: 8px 0 0;
      position:relative;
      z-index:1;
    }
    .note{
      margin: 8px 0 0;
      font-size: 12px;
      line-height:1.35;
      color: rgba(245,239,230,.72);
      position:relative;
      z-index:1;
    }

    .cut.head{border-left: 5px solid rgba(255,77,77,.9)}
    .cut.heart{border-left: 5px solid rgba(55,211,138,.9)}
    .cut.tail{border-left: 5px solid rgba(180,83,9,.6)}

    .dilute{
      border-radius: 18px;
      border:1px solid rgba(246,178,95,.30);
      background: linear-gradient(135deg, rgba(246,178,95,.18), rgba(180,83,9,.10));
      padding: 14px 14px;
    }
    .dilute p{margin:0}
    .dilute .k{
      font-size: 12px;
      letter-spacing:.12em;
      text-transform: uppercase;
      color: rgba(246,178,95,.95);
      margin-bottom: 6px;
    }
    .dilute strong{font-size: 18px; color: rgba(255,245,233,.98)}

    .aside{
      display:grid;
      gap: clamp(14px, 2.6vw, 22px);
    }

    .how{
      border-radius: 26px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.04);
      box-shadow: var(--shadow);
      padding: clamp(16px, 2.2vw, 22px);
    }
    .how h2{
      margin:0;
      font-family: Fraunces, serif;
      font-weight: 650;
      letter-spacing:-.02em;
      font-size: 20px;
    }
    .steps{
      margin: 12px 0 0;
      padding: 0;
      list-style: none;
      display:grid;
      gap:10px;
      color: rgba(245,239,230,.75);
      font-size: 13px;
      line-height:1.45;
    }
    .steps li{
      padding: 10px 12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }
    .steps b{color: rgba(255,245,233,.96)}
    .small{
      font-size: 12px;
      color: rgba(245,239,230,.65);
      margin-top: 12px;
    }

    .reveal{
      opacity:0;
      transform: translateY(10px);
      animation: in .7s ease forwards;
    }
    .d1{animation-delay:.05s}
    .d2{animation-delay:.12s}
    .d3{animation-delay:.18s}
    .d4{animation-delay:.24s}
    @keyframes in{
      to{opacity:1; transform: translateY(0)}
    }

    footer{
      margin-top: 18px;
      text-align:center;
      color: rgba(245,239,230,.55);
      font-size: 12px;
    }
    a{color: rgba(246,178,95,.9)}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="shell">

      <header class="reveal d1">
        <div class="hero">
          <div class="brand">
            <h1>Mastro Distillatore</h1>
            <p>Dalla materia prima al bicchiere. Stima dei tagli e diluizione (valori indicativi).</p>
          </div>
          <div class="badge" title="Consiglio: su iPhone usa Condividi → Aggiungi a Home">
            <span class="dot" aria-hidden="true"></span>
            <span>Icona: Alambicco</span>
          </div>
        </div>

        <div class="grid" style="margin-top:18px">
          <div class="panel reveal d2">
            <div class="grid">
              <div>
                <label for="tipoDistillato">Cosa vuoi produrre?</label>
                <select id="tipoDistillato">
                  <option value="grappa">Grappa (Vinacce)</option>
                  <option value="whisky">Whisky (Malto d'orzo)</option>
                  <option value="vodka">Vodka (Patate/Cereali)</option>
                  <option value="rum">Rum (Melassa/Zucchero)</option>
                </select>
              </div>

              <div class="ingredients" id="boxIngredienti">
                <h3>Ingredienti classici</h3>
                <ul id="listaIngredienti"></ul>
              </div>

              <div class="two">
                <div>
                  <label for="volume">Volume in caldaia (L)</label>
                  <input type="number" id="volume" value="10" inputmode="decimal" min="0" step="0.1" />
                </div>
                <div>
                  <label for="grado">Grado fermentato (%)</label>
                  <input type="number" id="grado" value="12" inputmode="decimal" min="0" step="0.1" />
                </div>
              </div>

              <button class="btn" id="btnCalcola">Genera guida lavorazione</button>

              <section class="results" id="risultati" aria-live="polite">
                <article class="cut head">
                  <h4>1. Testa (scarto) <span class="temp">70°C – 78°C</span></h4>
                  <div class="mono" id="resTesta">~ 0 ml</div>
                  <p class="note">Elimina subito: può contenere composti indesiderati. (Nota: la sicurezza dipende da processo e normative.)</p>
                </article>

                <article class="cut heart">
                  <h4>2. Cuore (il buono) <span class="temp">78.5°C – 91°C</span></h4>
                  <div class="mono" id="resCuore">~ 0 ml</div>
                  <p class="note">Raccogli qui il distillato “nobile”. Quando il vapore sale, aromi e componenti cambiano.</p>
                </article>

                <article class="cut tail">
                  <h4>3. Coda (scarto/riciclo) <span class="temp">&gt; 92°C</span></h4>
                  <p class="note">Smetti di raccogliere per il consumo: aumentano le note pesanti e gli oli.</p>
                </article>

                <div class="dilute">
                  <p class="k">Diluizione per il consumo (40%)</p>
                  <p>Aggiungi <strong id="resAcqua">0 ml</strong> di acqua distillata al cuore (stima).</p>
                </div>
              </section>
            </div>
          </div>
        </div>

        <footer>
          Suggerimento iPhone: apri in Safari → Condividi → <b>Aggiungi a Home</b>.
        </footer>
      </header>

      <aside class="aside">
        <section class="how reveal d3">
          <h2>Ti faccio “tutto” io: cosa devi fare tu</h2>
          <ol class="steps">
            <li><b>1)</b> Copia questo file come <b>index.html</b>.</li>
            <li><b>2)</b> Metti <b>index.html</b> online (serve un sito, anche gratis).</li>
            <li><b>3)</b> Da iPhone apri l’indirizzo in <b>Safari</b> (non Chrome).</li>
            <li><b>4)</b> Premi <b>Condividi</b> → <b>Aggiungi a Home</b>. L’icona sarà l’<b>alambicco</b>.</li>
          </ol>
          <p class="small">
            Se mi dici dove la vuoi pubblicare (es. GitHub Pages / Netlify / Aruba / Altervista),
            ti scrivo i passaggi precisi “clic per clic”.
          </p>
        </section>

        <section class="how reveal d4">
          <h2>Nota importante</h2>
          <p class="small" style="margin:12px 0 0">
            Questa pagina calcola <b>stime</b>. Distillazione e alcol possono essere regolamentati e pericolosi:
            segui normative locali e buone pratiche di sicurezza.
          </p>
        </section>
      </aside>

    </div>
  </div>

  <script>
    const datiDistillati = {
      grappa: ["Vinacce fresche o fermentate", "Acqua (se secche)", "Lieviti selezionati (opzionali)"],
      whisky: ["Malto d'orzo macinato", "Acqua pura", "Lieviti da birra/distilleria", "Torba (opzionale)"],
      vodka: ["Patate o grano", "Enzimi alfa-amilasi", "Acqua", "Lievito ad alta tolleranza"],
      rum: ["Melassa di canna o succo di canna", "Acqua", "Lieviti specifici per rum"]
    };

    function aggiornaRicetta() {
      const tipo = document.getElementById('tipoDistillato').value;
      const lista = document.getElementById('listaIngredienti');
      lista.innerHTML = "";
      datiDistillati[tipo].forEach(ing => {
        const li = document.createElement('li');
        li.textContent = ing;
        lista.appendChild(li);
      });
    }

    function calcolaTutto() {
      const V = parseFloat(document.getElementById('volume').value);
      const G = parseFloat(document.getElementById('grado').value);

      if (!Number.isFinite(V) || !Number.isFinite(G) || V <= 0 || G <= 0) {
        alert("Inserisci volume e grado validi.");
        return;
      }

      const alcolPuro = V * (G / 100);

      // Testa ~5% dell'alcol puro
      const testa = alcolPuro * 0.05 * 1000;

      // Cuore: 70% dell'alcol totale, ipotizzando uscita media 75%
      const cuore = (alcolPuro * 0.70) / 0.75 * 1000;

      // Diluizione a 40% da 75%
      const acqua = cuore * ((75 / 40) - 1);

      document.getElementById('risultati').classList.add('show');
      document.getElementById('resTesta').textContent = "~ " + Math.round(testa) + " ml";
      document.getElementById('resCuore').textContent = "~ " + Math.round(cuore) + " ml";
      document.getElementById('resAcqua').textContent = Math.round(acqua) + " ml";

      document.getElementById('risultati').scrollIntoView({behavior:'smooth', block:'start'});
    }

    document.getElementById('tipoDistillato').addEventListener('change', aggiornaRicetta);
    document.getElementById('btnCalcola').addEventListener('click', calcolaTutto);

    aggiornaRicetta();

    // Create manifest on the fly if hosting doesn't allow extra files (fallback)
    // NOTE: iOS mainly uses apple-touch-icon; manifest helps Android/desktop.
    (function ensureManifest(){
      const link = document.querySelector('link[rel="manifest"]');
      if (!link) return;

      // If you can't create manifest.webmanifest as a real file, this fallback still helps in many browsers.
      // iOS may ignore it, but apple-touch-icon above already solves your iPhone icon.
      try{
        const manifest = {
          name: "Mastro Distillatore",
          short_name: "Distillatore",
          start_url: ".",
          display: "standalone",
          background_color: "#140f0a",
          theme_color: "#a54a12",
          icons: [
            {
              src: document.querySelector('link[rel="apple-touch-icon"]').href,
              sizes: "180x180",
              type: "image/svg+xml",
              purpose: "any"
            }
          ]
        };
        const blob = new Blob([JSON.stringify(manifest)], {type:'application/manifest+json'});
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
      } catch(e){}
    })();
  </script>
</body>
</html>
